 
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Alkalinity Lab Simulator</title>
<style>
/* --- General Layout --- */
body { font-family:'Roboto','Arial',sans-serif; display:flex; justify-content:center; align-items:flex-start; min-height:100vh; margin:0; background:#f0f4f8; color:#333; padding:30px; box-sizing:border-box; }
.main-content { display:flex; gap:30px; max-width:1400px; width:100%; justify-content:center; align-items:flex-start; }
.lab-container { background:#fff; border-radius:12px; box-shadow:0 8px 30px rgba(0,0,0,0.1); padding:35px; text-align:center; flex:2; min-width:650px; }
h1 { color:#00796b; font-size:1.8em; margin-bottom:30px; }

/* --- Reagent Boxes --- */
.reagent-boxes { display:flex; justify-content:center; gap:15px; margin-bottom:40px; flex-wrap:wrap; }
.reagent-box { background:#4db6ac; color:white; padding:12px 20px; border-radius:8px; cursor:pointer; font-weight:bold; transition:0.3s; }
.reagent-box:hover { background:#00897b; transform:translateY(-3px); }

/* --- APPARATUS CONTAINER --- */
.apparatus-container { 
    display:flex; 
    justify-content:center; 
    align-items:flex-end; 
    margin-bottom:50px; 
    height: 550px; 
    position:relative; 
    width:100%; 
}

/* --- 1. The Stand (Flat Style) --- */
.stand-base {
    position: absolute;
    bottom: 0;
    left: 30%;
    width: 200px;
    height: 15px;
    background-color: #333;
    border-radius: 4px;
    z-index: 2;
}

.stand-rod {
    position: absolute;
    bottom: 15px; 
    left: 35%; 
    width: 10px;
    height: 520px;
    background-color: #333;
    z-index: 1;
}

.stand-clamp {
    position: absolute;
    top: 100px; /* Adjusted clamp position */
    left: 35%;
    width: 80px; 
    height: 10px;
    background-color: #333;
    z-index: 1;
}

/* --- 2. The Burette (Pink Flat Style) --- */
.burette-group {
    position: absolute;
    top: 50px; /* Moves the whole burette up */
    left: calc(35% + 70px); 
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 5;
}

.burette-body {
    width: 40px;
    height: 300px; /* Shortened height to create gap */
    border: 2px solid #333;
    background-color: #fff; 
    position: relative;
    border-radius: 2px;
}

/* The liquid inside the burette */
.burette-liquid {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 0%; 
    background-color: #bbd7f8; 
    transition: height 0.5s ease-out;
    z-index: 1;
}

/* Tick Marks Overlay */
.burette-ticks {
    position: absolute;
    top: 10px;
    right: 0;
    width: 100%;
    height: 280px; /* Matches body height minus padding */
    z-index: 2;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: flex-end;
}
.tick {
    width: 8px;
    height: 1px;
    background-color: #555;
    margin-bottom: 5px; 
}
.tick.long { width: 15px; }

/* Stopcock */
.stopcock {
    width: 20px;
    height: 12px;
    background-color: #333;
    margin-top: -2px;
    position: relative;
    z-index: 6;
}
.stopcock::after { 
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    width: 6px;
    height: 8px; /* The nozzle tip */
    background-color: #333;
}

/* --- 3. The Drop --- */
.drop { 
    position:absolute; 
    top: 375px; /* Positioned exactly in the gap */
    left: calc(35% + 90px); 
    transform:translateX(-50%); 
    width:8px; height:8px; 
    border-radius:50%; 
    background:#f8bbd0; 
    opacity:0; 
    z-index:8; 
}
.drop.animate { animation:fall 0.3s linear forwards; }
@keyframes fall { 
    0% { transform:translate(-50%,0); opacity:1; } 
    100% { transform:translate(-50%,120px); opacity:0; } /* Falls into beaker */
}

/* --- 4. The Beaker (Flat Style) --- */
.beaker-container { 
    position:absolute; 
    bottom: 15px; 
    left: calc(35% + 20px); 
    z-index:10; 
}

.beaker { 
    width:140px; 
    height:150px; /* Slightly shorter beaker */
    border: 2px solid #333; 
    border-top:none; 
    border-radius:0 0 20px 20px; 
    position:relative; 
    overflow:hidden; 
    background:rgba(255,255,255,0.9); 
}

/* Beaker Liquid */
.beaker-liquid { 
    width:100%; 
    height:0%; 
    background:transparent; 
    position:absolute; 
    bottom:0; 
    transition:height 0.1s linear, background-color 0.5s ease-out; 
}

.stir-bar {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    width: 25px;
    height: 6px;
    background-color: white;
    border: 1px solid #ddd;
    border-radius: 3px;
    z-index: 15;
}

.color-clear { background:#e1f5fe !important; } 
.color-pink { background:#fed5f0 !important; }
.color-yellow { background:#fff59d !important; }
.color-orange { background:#ffd700 !important; }


/* --- Input Section --- */
.input-section { margin-top:20px; margin-bottom:30px; background:#fff; padding:25px; border-radius:10px; display:inline-block; text-align:left; width:90%; box-shadow:0 4px 10px rgba(0,0,0,0.05); border:1px solid #e0e0e0; }
.input-section h2, .input-section h3 { color:#00796b; margin:0 0 20px; font-weight:500; }
.input-section label { display:block; margin-bottom:5px; font-weight:600; color:#555; }
.input-section input[type=number] { width:200px; padding:12px; margin-bottom:20px; border:1px solid #bdbdbd; border-radius:6px; font-size:16px; transition:0.3s; }
.input-section input[type=number]:focus { border-color:#00796b; outline:none; box-shadow:0 0 0 3px rgba(0,121,107,0.2); }

.titration-controls { margin:25px 0; padding:20px; background:#e0f2f1; border-radius:8px; border-left:5px solid #00796b; box-shadow:inset 0 1px 3px rgba(0,0,0,0.05); }

.input-section button { background:#00796b; color:white; padding:12px 30px; border:none; border-radius:8px; cursor:pointer; font-size:1.1em; font-weight:bold; transition:0.3s; margin:10px 5px; }
.input-section button:hover { background:#004d40; transform:translateY(-2px); }
#titrate-p-button, #titrate-m-button { background:#1976d2; }
#titrate-p-button:hover, #titrate-m-button:hover { background:#1565c0; }
#reset-button { background:#e53935; }
#reset-button:hover { background:#c62828; }

/* --- Results --- */
.results-section { background:#f7f9fb; padding:25px; border-radius:10px; margin-top:30px; display:inline-block; text-align:left; width:90%; border:2px solid #00796b; box-shadow:0 4px 15px rgba(0,0,0,0.1); }
.results-section h2 { color:#004d40; margin-top:0; border-bottom:2px dashed #00796b30; padding-bottom:10px; }
.results-section span { font-weight:700; color:#d81b60; }

/* Sidebar */
.right-sidebar { display:flex; flex-direction:column; gap:20px; flex:1; min-width:350px; max-width:500px; }
.instruction-box { background:#fff3e0; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.1); padding:25px; }
.instruction-box h2 { color:#e65100; margin-top:0; }

/* Chart */
.chart-container { background:white; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.1); overflow:hidden; }
.calc-table { width:100%; border-collapse:collapse; font-size:0.9em; }
.calc-table th { padding:12px; color:white; font-weight:bold; text-align:center; }
.header-main, .header-sub { background:#00796b; }
.calc-table td { padding:10px; text-align:center; border-bottom:1px solid #eee; }

#notification-area { position:fixed; top:20px; left:50%; transform:translateX(-50%); background:#2e7d32; color:white; padding:15px 30px; border-radius:8px; display:none; font-size:1.1em; font-weight:bold; z-index:1000; }
</style>
</head>
<body>
<div class="main-content">
<div id="notification-area"></div>
<div class="lab-container">
<h1>Determination of Alkalinity in Water</h1>

<div class="reagent-boxes">
<div class="reagent-box" id="acid-reagent">Standard HCl (Burette)</div>
<div class="reagent-box" id="water-sample-reagent">Water Sample (Flask)</div>
<div class="reagent-box" id="phenolphthalein-reagent">Phenolphthalein (P)</div>
<div class="reagent-box" id="methyl-orange-reagent">Methyl Orange (M)</div>
</div>

<div class="apparatus-container">
    
    <div class="stand-base"></div>
    <div class="stand-rod"></div>
    <div class="stand-clamp"></div>

    <div class="burette-group">
        <div class="burette-body">
            <div class="burette-liquid" id="burette-liquid"></div>
            <div class="burette-ticks">
                <div class="tick long"></div><div class="tick"></div><div class="tick"></div><div class="tick"></div>
                <div class="tick long"></div><div class="tick"></div><div class="tick"></div><div class="tick"></div>
                <div class="tick long"></div><div class="tick"></div><div class="tick"></div><div class="tick"></div>
                <div class="tick long"></div><div class="tick"></div><div class="tick"></div><div class="tick"></div>
                <div class="tick long"></div><div class="tick"></div><div class="tick"></div><div class="tick"></div>
                <div class="tick long"></div><div class="tick"></div>
            </div>
        </div>
        <div class="stopcock"></div>
    </div>

    <div id="titration-drop" class="drop"></div>

    <div class="beaker-container">
        <div class="beaker">
            <div class="beaker-liquid" id="beaker-liquid"></div>
            <div class="stir-bar"></div>
        </div>
    </div>

</div>

<div class="input-section">
<h2>Titration Data Input</h2>
<label>Water Sample Volume (mL):</label>
<input type="number" id="sample-volume" value="50">

<label>Standard Acid Normality (N):</label>
<input type="number" id="acid-normality" value="0.02" step="0.001">

<div class="titration-controls">
<h3>Step 1: Phenolphthalein Alkalinity (P)</h3>
<button id="titrate-p-button">Start P Titration</button>
<label>P Endpoint Volume (V1):</label>
<input type="number" id="p-titrated-volume" value="0.0" step="0.1">
</div>

<div class="titration-controls">
<h3>Step 2: Total Alkalinity (M)</h3>
<button id="titrate-m-button">Start M Titration</button>
<label>M Endpoint Volume (V2):</label>
<input type="number" id="m-titrated-volume" value="0.0" step="0.1">
</div>

<button id="calculate-alkalinity">Calculate Alkalinity</button>
<button id="reset-button">Reset</button>
</div>

<div class="results-section">
<h2>Results:</h2>
<p>Phenolphthalein Alkalinity (P): <span id="p-alkalinity-display"></span> ppm</p>
<p>Total Alkalinity (M): <span id="t-alkalinity-display"></span> ppm</p>
</div>
</div>

<div class="right-sidebar">
<div class="instruction-box"><h2>Instructions</h2><p id="current-instruction">Start by filling the burette with Standard HCl.</p></div>
<div class="chart-container">
<table class="calc-table">
<thead><tr><th colspan="4" class="header-main">Calculation Logic</th></tr>
<tr><th class="header-sub">Condition</th><th class="header-sub">OH⁻</th><th class="header-sub">CO₃²⁻</th><th class="header-sub">HCO₃⁻</th></tr>
</thead>
<tbody>
<tr><td>P = 0</td><td>0</td><td>0</td><td>M</td></tr>
<tr><td>P = 1/2 M</td><td>0</td><td>2P</td><td>0</td></tr>
<tr><td>P > 1/2 M</td><td>2P - M</td><td>2(M - P)</td><td>0</td></tr>
<tr><td>P < 1/2 M</td><td>0</td><td>2P</td><td>M - 2P</td></tr>
<tr><td>P = M</td><td>P</td><td>0</td><td>0</td></tr>
</tbody>
</table>
</div>
</div>
</div>

<script>
/* JS LOGIC */

const buretteLiquid=document.getElementById("burette-liquid");
const beakerLiquid=document.getElementById("beaker-liquid");
const titrationDrop=document.getElementById("titration-drop");

const acidReagent=document.getElementById("acid-reagent");
const waterSampleReagent=document.getElementById("water-sample-reagent");
const phenolphthaleinReagent=document.getElementById("phenolphthalein-reagent");
const methylOrangeReagent=document.getElementById("methyl-orange-reagent");

const sampleVolumeInput=document.getElementById("sample-volume");
const acidNormalityInput=document.getElementById("acid-normality");
const pTitratedVolumeInput=document.getElementById("p-titrated-volume");
const mTitratedVolumeInput=document.getElementById("m-titrated-volume");

const titratePButton=document.getElementById("titrate-p-button");
const titrateMButton=document.getElementById("titrate-m-button");
const calculateButton=document.getElementById("calculate-alkalinity");
const resetButton=document.getElementById("reset-button");

const pAlkalinityDisplay=document.getElementById("p-alkalinity-display");
const tAlkalinityDisplay=document.getElementById("t-alkalinity-display");
const currentInstructionDisplay=document.getElementById("current-instruction");
const notificationArea=document.getElementById("notification-area");

let titrationActive=false;
let acidAddedVolume=0.0;
let currentStage="start";
let beakerHasSample=false;
let beakerHasP=false;
let beakerHasM=false;
let titrationTimer=null;

const SIMULATED_P_ENDPOINT=5.0;
const SIMULATED_M_ENDPOINT=12.0;

function showNotification(msg,err=false){notificationArea.textContent=msg;notificationArea.style.display='block';notificationArea.style.backgroundColor=err?'#f44336':'#2e7d32';setTimeout(()=>notificationArea.style.display='none',3000);}
function updateInstructions(msg){currentInstructionDisplay.textContent=msg;}

function resetSimulation(){ 
    titrationActive=false; acidAddedVolume=0; currentStage="start"; 
    beakerHasSample=false; beakerHasP=false; beakerHasM=false;
    if(titrationTimer){clearTimeout(titrationTimer);} 
    
    // Reset Visuals
    buretteLiquid.style.height="0%"; 
    beakerLiquid.style.height="0%"; 
    beakerLiquid.className='beaker-liquid'; // Removes colors
    
    pTitratedVolumeInput.value="0.0"; mTitratedVolumeInput.value="0.0";
    pAlkalinityDisplay.textContent=""; tAlkalinityDisplay.textContent=""; 
    updateInstructions("Start by filling the burette with Standard HCl."); 
    showNotification("Simulation reset!"); 
}

function fillBurette(){ 
    // Fills the pink liquid
    buretteLiquid.style.height="100%"; 
    updateInstructions("Burette filled. Add Water Sample."); 
}

function addSample(){ 
    beakerLiquid.style.height="25%"; 
    beakerLiquid.className='beaker-liquid color-clear'; // Light blue per image
    beakerHasSample=true; 
    updateInstructions("Sample added. Add Phenolphthalein."); 
}

function addPhenolphthalein(){ 
    if(!beakerHasSample){showNotification("Add sample first!",true);return;} 
    beakerLiquid.className='beaker-liquid color-pink'; 
    beakerHasP=true; 
    updateInstructions("Phenolphthalein added. Start P titration."); 
}

function addMethylOrange(){ 
    if(!beakerHasSample){showNotification("Add sample first!",true);return;} 
    beakerLiquid.className='beaker-liquid color-yellow'; 
    beakerHasM=true; 
    updateInstructions("Methyl Orange added. Start M titration."); 
}

function triggerDropAnimation(){ 
    titrationDrop.style.opacity=0; 
    titrationDrop.classList.remove('animate'); 
    void titrationDrop.offsetWidth; 
    titrationDrop.classList.add('animate'); 
}

function titrateStep(){ 
    if(!titrationActive)return; 
    
    let h=parseFloat(buretteLiquid.style.height);
    if(h<=5){ showNotification("Burette empty!",true); titrationActive=false; return; }
    
    triggerDropAnimation(); 
    acidAddedVolume+=0.1; 
    
    // Lower burette liquid
    buretteLiquid.style.height=(h-0.5)+"%";
    
    // Raise beaker liquid slightly
    let bh=parseFloat(beakerLiquid.style.height); 
    beakerLiquid.style.height=Math.min(bh+0.05,70)+"%";
    
    if(currentStage=="p_titration" && acidAddedVolume>=SIMULATED_P_ENDPOINT){ 
        beakerLiquid.className='beaker-liquid color-clear'; 
        titrationActive=false; 
        pTitratedVolumeInput.value=acidAddedVolume.toFixed(1); 
        showNotification("P endpoint reached"); 
        updateInstructions("Now add Methyl Orange."); 
        return; 
    }
    
    if(currentStage=="m_titration" && acidAddedVolume>=SIMULATED_M_ENDPOINT){ 
        beakerLiquid.className='beaker-liquid color-orange'; 
        titrationActive=false; 
        mTitratedVolumeInput.value=acidAddedVolume.toFixed(1); 
        showNotification("M endpoint reached"); 
        updateInstructions("Titration complete."); 
        return; 
    }
    
    titrationTimer=setTimeout(titrateStep,100); 
}

function startPTitration(){ 
    if(!beakerHasP){showNotification("Add P indicator!",true);return;} 
    currentStage="p_titration"; 
    titrationActive=true; 
    titrateStep(); 
}

function startMTitration(){ 
    if(!beakerHasM){showNotification("Add M indicator!",true);return;} 
    currentStage="m_titration"; 
    titrationActive=true; 
    titrateStep(); 
}

function calculateAlkalinity(){ 
    const N=parseFloat(acidNormalityInput.value); 
    const V1=parseFloat(pTitratedVolumeInput.value); 
    const V2=parseFloat(mTitratedVolumeInput.value); 
    const SV=parseFloat(sampleVolumeInput.value);
    
    if(SV===0)return; 
    pAlkalinityDisplay.textContent=((V1*N*50*1000)/SV).toFixed(2); 
    tAlkalinityDisplay.textContent=((V2*N*50*1000)/SV).toFixed(2);
    showNotification("Calculations complete!"); 
}

acidReagent.onclick=fillBurette; 
waterSampleReagent.onclick=addSample; 
phenolphthaleinReagent.onclick=addPhenolphthalein; 
methylOrangeReagent.onclick=addMethylOrange;

titratePButton.onclick=startPTitration; 
titrateMButton.onclick=startMTitration; 
calculateButton.onclick=calculateAlkalinity; 
resetButton.onclick=resetSimulation;

resetSimulation();
</script>
</body>
</html>
```